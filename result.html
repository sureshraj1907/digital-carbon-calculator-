<!DOCTYPE html>
<html>
<head>
    <title>Carbon Footprint Result</title>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>

    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
            color: white;
            text-align: center;
        }

        .container {
            width: 85%;
            margin: auto;
            padding: 20px;
        }

        .card {
            background: rgba(0, 0, 0, 0.7);
            padding: 20px;
            margin: 20px 0;
            border-radius: 15px;
            box-shadow: 0 0 20px #00c6ff;
        }

        h1 {
            margin-top: 20px;
        }

        canvas {
            background: rgba(0,0,0,0.4);
            border-radius: 10px;
            padding: 10px;
        }

        a {
            display: inline-block;
            margin-top: 20px;
            padding: 10px 20px;
            background: #00c6ff;
            color: black;
            text-decoration: none;
            border-radius: 8px;
            font-weight: bold;
        }

        a:hover {
            background: #00a2d3;
        }
    </style>
</head>

<body>

<div class="container">

    <h1>Monthly Digital Carbon Footprint</h1>

    <div class="card">
        <h2>Total Carbon Emission: {{ total }} kg</h2>
        <h2>Eco Score: <span id="ecoScore"></span> / 100</h2>
    </div>

    <div class="card">
        <h2>Emission Breakdown</h2>
        <canvas id="carbonChart"></canvas>
    </div>

    <div class="card">
        <h2>AI Sustainability Suggestion</h2>
        <p id="aiSuggestion"></p>
    </div>

    <a href="/">Calculate Again</a>

</div>

<script>

const total = {{ total }};

// ECO SCORE CALCULATION
let ecoScore = 100 - (total / 5);

if (ecoScore < 0) {
    ecoScore = 0;
}

if (ecoScore > 100) {
    ecoScore = 100;
}

ecoScore = Math.round(ecoScore);

document.getElementById("ecoScore").innerText = ecoScore;


// AI SUGGESTION LOGIC

let suggestionText = "";

if (total < 100) {
    suggestionText = "Low ðŸŒ± Your digital carbon footprint is under control. Maintain sustainable habits.";
}
else if (total >= 100 && total < 300) {
    suggestionText = "Moderate âš¡ Try reducing car travel and screen time to lower emissions.";
}
else if (total >= 300 && total < 600) {
    suggestionText = "High ðŸš¨ Your footprint is high. Consider optimizing transportation and digital usage.";
}
else {
    suggestionText = "Very High ðŸ”´ Immediate reduction recommended. Shift to eco-friendly practices.";
}

document.getElementById("aiSuggestion").innerText = suggestionText;


// BAR CHART

const ctx = document.getElementById('carbonChart').getContext('2d');

new Chart(ctx, {
    type: 'bar',
    data: {
        labels: [
            'Car',
            'Internet',
            'Mobile',
            'Streaming',
            'Gaming',
            'Social Media',
            'Laptop'
        ],
        datasets: [{
            label: 'Monthly CO2 Emission (kg)',
            data: [
                {{ car }},
                {{ internet }},
                {{ mobile }},
                {{ streaming }},
                {{ gaming }},
                {{ social }},
                {{ laptop }}
            ],
            backgroundColor: [
                '#ff4d4d',
                '#ffa500',
                '#00c6ff',
                '#8a2be2',
                '#ff1493',
                '#32cd32',
                '#ffff00'
            ],
            borderRadius: 8
        }]
    },
    options: {
        responsive: true,
        animations: {
            y: {
                from: 0,
                duration: 2000
            }
        },
        plugins: {
            legend: {
                labels: {
                    color: 'white'
                }
            }
        },
        scales: {
            x: {
                ticks: { color: 'white' },
                grid: { display: false }
            },
            y: {
                ticks: { color: 'white' },
                grid: { color: '#444' }
            }
        }
    }
});

</script>

</body>
</html>